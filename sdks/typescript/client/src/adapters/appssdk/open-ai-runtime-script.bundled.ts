// This file is auto-generated by scripts/bundle-open-ai-script.js
// Do not edit directly - modify client/src/adapters/appssdk/open-ai-runtime-script.ts instead

export const API_RUNTIME_SCRIPT = "\"use strict\";\n(() => {\n  // src/adapters/appssdk/open-ai-runtime-script.ts\n  var DEFAULT_SAFE_AREA = {\n    insets: {\n      top: 0,\n      bottom: 0,\n      left: 0,\n      right: 0\n    }\n  };\n  var DEFAULT_CAPABILITIES = {\n    hover: true,\n    touch: false\n  };\n  var TOOL_CALL_TIMEOUT_MS = 3e4;\n  (function initializeOpenAIWidget() {\n    const globalWindow = window;\n    const config = globalWindow.__MCP_WIDGET_CONFIG__;\n    if (!config || typeof config !== \"object\" || config.widgetStateKey == null) {\n      console.warn(\"[OpenAI Widget] Missing widget configuration. Skipping initialization.\");\n      return;\n    }\n    const {\n      widgetStateKey,\n      toolInput = null,\n      toolOutput = null,\n      toolResponseMetadata = null,\n      toolName = null,\n      theme,\n      locale,\n      userAgent = null,\n      model = null,\n      displayMode,\n      maxHeight,\n      safeArea,\n      capabilities\n    } = config;\n    const resolvedDisplayMode = typeof displayMode === \"string\" ? displayMode : \"inline\";\n    const resolvedMaxHeight = typeof maxHeight === \"number\" ? maxHeight : 600;\n    const resolvedTheme = typeof theme === \"string\" ? theme : \"light\";\n    const resolvedLocale = typeof locale === \"string\" ? locale : \"en-US\";\n    const resolvedSafeArea = safeArea && typeof safeArea === \"object\" ? safeArea : DEFAULT_SAFE_AREA;\n    const mergedCapabilities = {\n      ...DEFAULT_CAPABILITIES,\n      ...typeof capabilities === \"object\" && capabilities !== null ? capabilities : {}\n    };\n    const openaiAPI = {\n      toolInput,\n      toolOutput,\n      toolResponseMetadata,\n      toolName,\n      displayMode: resolvedDisplayMode,\n      maxHeight: resolvedMaxHeight,\n      theme: resolvedTheme,\n      locale: resolvedLocale,\n      safeArea: resolvedSafeArea,\n      userAgent,\n      capabilities: mergedCapabilities,\n      model,\n      widgetState: null,\n      async setWidgetState(state) {\n        this.widgetState = state;\n        try {\n          localStorage.setItem(widgetStateKey, JSON.stringify(state));\n        } catch (err) {\n          console.error(\"[OpenAI Widget] Failed to save widget state:\", err);\n        }\n        window.parent.postMessage(\n          {\n            type: \"openai:setWidgetState\",\n            state\n          },\n          \"*\"\n        );\n      },\n      async callTool(tool, params = {}) {\n        return new Promise((resolve, reject) => {\n          const requestId = `tool_${Date.now()}_${Math.random()}`;\n          const handler = (event) => {\n            const data = event.data;\n            if (data?.type === \"openai:callTool:response\" && data?.requestId === requestId) {\n              window.removeEventListener(\"message\", handler);\n              if (data.error) {\n                reject(new Error(data.error));\n              } else {\n                resolve(data.result);\n              }\n            }\n          };\n          window.addEventListener(\"message\", handler);\n          window.parent.postMessage(\n            {\n              type: \"openai:callTool\",\n              requestId,\n              toolName: tool,\n              params\n            },\n            \"*\"\n          );\n          setTimeout(() => {\n            window.removeEventListener(\"message\", handler);\n            reject(new Error(\"Tool call timeout\"));\n          }, TOOL_CALL_TIMEOUT_MS);\n        });\n      },\n      async sendFollowupTurn(message) {\n        const payload = typeof message === \"string\" ? { prompt: message } : message;\n        const value = payload?.prompt ?? payload;\n        window.parent.postMessage(\n          {\n            type: \"openai:sendFollowup\",\n            message: value\n          },\n          \"*\"\n        );\n      },\n      async requestDisplayMode(options = {}) {\n        const mode = typeof options.mode === \"string\" ? options.mode : this.displayMode || \"inline\";\n        this.displayMode = mode;\n        window.parent.postMessage(\n          {\n            type: \"openai:requestDisplayMode\",\n            mode\n          },\n          \"*\"\n        );\n        return { mode };\n      },\n      async sendFollowUpMessage(args) {\n        const prompt = typeof args === \"string\" ? args : args?.prompt ?? \"\";\n        await this.sendFollowupTurn(prompt);\n      },\n      async openExternal(options) {\n        const href = typeof options === \"string\" ? options : options?.href;\n        if (!href) {\n          throw new Error(\"href is required for openExternal\");\n        }\n        window.parent.postMessage(\n          {\n            type: \"openai:openExternal\",\n            href\n          },\n          \"*\"\n        );\n        window.open(href, \"_blank\", \"noopener,noreferrer\");\n      }\n    };\n    if (openaiAPI.userAgent == null && typeof navigator !== \"undefined\") {\n      try {\n        openaiAPI.userAgent = navigator.userAgent || \"\";\n      } catch {\n        openaiAPI.userAgent = \"\";\n      }\n    }\n    Object.defineProperty(window, \"openai\", {\n      value: openaiAPI,\n      writable: false,\n      configurable: false,\n      enumerable: true\n    });\n    Object.defineProperty(window, \"webplus\", {\n      value: openaiAPI,\n      writable: false,\n      configurable: false,\n      enumerable: true\n    });\n    setTimeout(() => {\n      try {\n        const globalsEvent = new CustomEvent(\"webplus:set_globals\", {\n          detail: {\n            globals: {\n              displayMode: openaiAPI.displayMode,\n              maxHeight: openaiAPI.maxHeight,\n              theme: openaiAPI.theme,\n              locale: openaiAPI.locale,\n              safeArea: openaiAPI.safeArea,\n              userAgent: openaiAPI.userAgent,\n              capabilities: openaiAPI.capabilities\n            }\n          }\n        });\n        window.dispatchEvent(globalsEvent);\n      } catch {\n      }\n    }, 0);\n    setTimeout(() => {\n      try {\n        const stored = localStorage.getItem(widgetStateKey);\n        if (stored) {\n          openaiAPI.widgetState = JSON.parse(stored);\n        }\n      } catch {\n      }\n    }, 0);\n    try {\n      delete globalWindow.__MCP_WIDGET_CONFIG__;\n    } catch {\n      globalWindow.__MCP_WIDGET_CONFIG__ = void 0;\n    }\n  })();\n})();\n";
